<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/nextgen-adsdk-android-release/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/nextgen-adsdk-android-release/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul:nth-of-type(1) > li > ul > li:not(:nth-child(7)) > a, .site-nav > ul:nth-of-type(1) > li > ul > li > ul > li a { background-image: none; } .site-nav > ul:not(:nth-of-type(1)) a, .site-nav li.external a { background-image: none; } .site-nav > ul:nth-of-type(1) > li > ul > li:nth-child(7) > a { font-weight: 600; text-decoration: none; } .site-nav > ul.nav-category-list > li > button svg, .site-nav > ul:nth-of-type(1) > li > ul > li:nth-child(7) > button svg { transform: rotate(-90deg); } .site-nav > ul.nav-category-list > li.nav-list-item > ul.nav-list, .site-nav > ul:nth-of-type(1) > li > ul > li.nav-list-item:nth-child(7) > ul.nav-list { display: block; } </style> <script src="/nextgen-adsdk-android-release/assets/js/vendor/lunr.min.js"></script> <script src="/nextgen-adsdk-android-release/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Global request parameters | AdSDK Documentation</title> <meta name="generator" content="Jekyll v3.10.0" /> <meta property="og:title" content="Global request parameters" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Global request parameters" /> <meta property="og:description" content="Global request parameters" /> <link rel="canonical" href="https://vm-mobile-sdk.github.io/nextgen-adsdk-android-release/6.0.0/global-request-parameters.html" /> <meta property="og:url" content="https://vm-mobile-sdk.github.io/nextgen-adsdk-android-release/6.0.0/global-request-parameters.html" /> <meta property="og:site_name" content="AdSDK Documentation" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Global request parameters" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Global request parameters","headline":"Global request parameters","url":"https://vm-mobile-sdk.github.io/nextgen-adsdk-android-release/6.0.0/global-request-parameters.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/nextgen-adsdk-android-release/" class="site-title lh-tight"> AdSDK Documentation </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list nav-category-list"> <li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="Toggle collection SDK v.6.0.0" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><div class="nav-category">SDK v.6.0.0</div> <ul class="nav-list"><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/6.0.0/meet-adsdk.html" class="nav-list-link">Meet nextgen AdSDK</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/6.0.0/first-steps.html" class="nav-list-link">First steps for working with AdSDK</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/6.0.0/create-and-display-inline-ads.html" class="nav-list-link">Create and display inline ads</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/6.0.0/create-and-display-interstitial-ad.html" class="nav-list-link">Create and display interstitial ad</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/6.0.0/handling-the-ad-events.html" class="nav-list-link">Handling the ad events</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/6.0.0/user-tagging-conversion-tracking.html" class="nav-list-link">User tagging and conversion tracking</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/6.0.0/global-request-parameters.html" class="nav-list-link">Global request parameters</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/6.0.0/cache-management.html" class="nav-list-link">AdSDK Cache Management</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/6.0.0/create-target-url-handler.html" class="nav-list-link">Custom handling of target tap URLs</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/6.0.0/creating-customised-advertising.html" class="nav-list-link">Creating customised advertising</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/6.0.0/compose_with_xml_guide.html" class="nav-list-link">How to use AdSDK with XML views</a></li></ul> </li> </ul> <ul class="nav-list nav-category-list"> <li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="Toggle collection SDK v.5.3.0" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><div class="nav-category">SDK v.5.3.0</div> <ul class="nav-list"><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.3.0/meet-adsdk.html" class="nav-list-link">Meet nextgen AdSDK</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.3.0/first-steps.html" class="nav-list-link">First steps for working with AdSDK</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.3.0/create-and-display-inline-ads.html" class="nav-list-link">Create and display inline ads</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.3.0/create-and-display-interstitial-ad.html" class="nav-list-link">Create and display interstitial ad</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.3.0/handling-the-ad-events.html" class="nav-list-link">Handling the ad events</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.3.0/user-tagging-conversion-tracking.html" class="nav-list-link">User tagging and conversion tracking</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.3.0/global-request-parameters.html" class="nav-list-link">Global request parameters</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.3.0/cache-management.html" class="nav-list-link">AdSDK Cache Management</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.3.0/creating-customised-advertising.html" class="nav-list-link">Creating customised advertising</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.3.0/compose_with_xml_guide.html" class="nav-list-link">How to use AdSDK with XML views</a></li></ul> </li> </ul> <ul class="nav-list nav-category-list"> <li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="Toggle collection SDK v.5.0.1" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><div class="nav-category">SDK v.5.0.1</div> <ul class="nav-list"><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.1/meet-adsdk.html" class="nav-list-link">Meet nextgen AdSDK</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.1/first-steps.html" class="nav-list-link">First steps for working with AdSDK</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.1/create-and-display-inline-ads.html" class="nav-list-link">Create and display inline ads</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.1/create-and-display-interstitial-ad.html" class="nav-list-link">Create and display interstitial ad</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.1/handling-the-ad-events.html" class="nav-list-link">Handling the ad events</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.1/user-tagging-conversion-tracking.html" class="nav-list-link">User tagging and conversion tracking</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.1/global-request-parameters.html" class="nav-list-link">Global request parameters</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.1/cache-management.html" class="nav-list-link">AdSDK Cache Management</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.1/creating-customised-advertising.html" class="nav-list-link">Creating customised advertising</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.1/compose_with_xml_guide.html" class="nav-list-link">How to use AdSDK with XML views</a></li></ul> </li> </ul> <ul class="nav-list nav-category-list"> <li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="Toggle collection SDK v.5.0.0" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><div class="nav-category">SDK v.5.0.0</div> <ul class="nav-list"><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.0/meet-adsdk.html" class="nav-list-link">Meet nextgen AdSDK</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.0/first-steps.html" class="nav-list-link">First steps for working with AdSDK</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.0/create-and-display-inline-ads.html" class="nav-list-link">Create and display inline ads</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.0/create-and-display-interstitial-ad.html" class="nav-list-link">Create and display interstitial ad</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.0/handling-the-ad-events.html" class="nav-list-link">Handling the ad events</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.0/user-tagging-conversion-tracking.html" class="nav-list-link">User tagging and conversion tracking</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.0/global-request-parameters.html" class="nav-list-link">Global request parameters</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/5.0.0/cache-management.html" class="nav-list-link">AdSDK Cache Management</a></li></ul> </li> </ul> <ul class="nav-list nav-category-list"> <li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="Toggle collection SDK v.4.6.0" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><div class="nav-category">SDK v.4.6.0</div> <ul class="nav-list"><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/4.6.0/meet-adsdk.html" class="nav-list-link">Meet nextgen AdSDK</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/4.6.0/create-and-display-inline-ads.html" class="nav-list-link">Create and display inline ads</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/4.6.0/handling-the-state-and-events-of-advertising.html" class="nav-list-link">Handling the state and events of advertising</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/4.6.0/defining-the-size-of-the-advertisement.html" class="nav-list-link">Defining the size of the advertisement</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/4.6.0/create-and-display-interstitial-ad-section.html" class="nav-list-link">Create and display interstitial ad section</a></li><li class="nav-list-item"><a href="/nextgen-adsdk-android-release/4.6.0/global-adRequest-parameters.html" class="nav-list-link">Global ad request parameters</a></li></ul> </li> </ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search AdSDK Documentation" aria-label="Search AdSDK Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <h1 id="global-request-parameters"> <a href="#global-request-parameters" class="anchor-heading" aria-labelledby="global-request-parameters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Global request parameters </h1> <p>We already know how to create and perform <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-ad-request/index.html">AdRequest</a>, <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-tag-request/index.html">TagRequest</a>, and <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-tracking-request/index.html">TrackingRequest</a>. However, each of them can have additional parameters, which are called global parameters because they are specified globally for all requests. The SDK provides the ability to add global parameters once so that you don’t have to copy them when creating each request.</p> <p>We will continue to build the app, so be sure to follow all the previous tutorials. You can download this <a href="https://github.com/VM-Mobile-SDK/nextgen-adsdk-android-tutorial/tree/built-in-capabilities/global-parameters">project</a> which has already implemented all steps from this tutorial.</p> <h2 id="section-1-preparing-the-app"> <a href="#section-1-preparing-the-app" class="anchor-heading" aria-labelledby="section-1-preparing-the-app"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Section 1: Preparing the app </h2> <p>The application should ask whether it is permitted to collect data about the user. In this section, we will add functionality for this.</p> <h3 id="step-1"> <a href="#step-1" class="anchor-heading" aria-labelledby="step-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 1 </h3> <p>Let’s open <code class="language-plaintext highlighter-rouge">MainScreen.kt</code>. Since we need to ask the user for permission, we create an <code class="language-plaintext highlighter-rouge">AlertDialog</code> in <code class="language-plaintext highlighter-rouge">MainScreen</code>.</p> <p><strong>File:</strong> <code class="language-plaintext highlighter-rouge">MainScreen.kt</code></p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="nd">@Composable</span>
<span class="k">fun</span> <span class="nf">MainScreen</span><span class="p">(</span>
    <span class="n">navController</span><span class="p">:</span> <span class="nc">NavController</span><span class="p">,</span>
    <span class="n">viewModel</span><span class="p">:</span> <span class="nc">MainViewModel</span> <span class="p">=</span> <span class="nf">viewModel</span><span class="p">()</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">uiState</span> <span class="k">by</span> <span class="n">viewModel</span><span class="p">.</span><span class="n">state</span><span class="p">.</span><span class="nf">collectAsState</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">showDialog</span> <span class="k">by</span> <span class="n">viewModel</span><span class="p">.</span><span class="n">showDialog</span><span class="p">.</span><span class="nf">collectAsState</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">showDialog</span><span class="p">)</span> <span class="p">{</span>
        <span class="nc">AlertDialog</span><span class="p">(</span>
            <span class="n">onDismissRequest</span> <span class="p">=</span> <span class="p">{</span>
                <span class="n">viewModel</span><span class="p">.</span><span class="n">showDialog</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="k">false</span>
                <span class="n">viewModel</span><span class="p">.</span><span class="nf">onLoad</span><span class="p">(</span><span class="k">false</span><span class="p">)</span>
            <span class="p">},</span>
            <span class="n">text</span> <span class="p">=</span> <span class="p">{</span> <span class="nc">Text</span><span class="p">(</span><span class="s">"Please grant the permission to collect the data"</span><span class="p">)</span> <span class="p">},</span>
            <span class="n">confirmButton</span> <span class="p">=</span> <span class="p">{</span>
                <span class="nc">TextButton</span><span class="p">(</span><span class="n">onClick</span> <span class="p">=</span> <span class="p">{</span>
                    <span class="n">viewModel</span><span class="p">.</span><span class="n">showDialog</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="k">false</span>
                    <span class="n">viewModel</span><span class="p">.</span><span class="nf">onLoad</span><span class="p">(</span><span class="k">true</span><span class="p">)</span>
                <span class="p">})</span> <span class="p">{</span>
                    <span class="nc">Text</span><span class="p">(</span><span class="s">"Allow"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="n">dismissButton</span> <span class="p">=</span> <span class="p">{</span>
                <span class="nc">TextButton</span><span class="p">(</span><span class="n">onClick</span> <span class="p">=</span> <span class="p">{</span>
                    <span class="n">viewModel</span><span class="p">.</span><span class="n">showDialog</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="k">false</span>
                    <span class="n">viewModel</span><span class="p">.</span><span class="nf">onLoad</span><span class="p">(</span><span class="k">false</span><span class="p">)</span>
                <span class="p">})</span> <span class="p">{</span>
                    <span class="nc">Text</span><span class="p">(</span><span class="s">"Deny"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="p">}</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">MainViewModel</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">adServiceProvider</span><span class="p">:</span> <span class="nc">AdServiceProviderInterface</span> <span class="p">=</span> <span class="nc">ServiceLocator</span><span class="p">.</span><span class="n">adServiceProvider</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">_state</span> <span class="p">=</span> <span class="nc">MutableStateFlow</span><span class="p">&lt;</span><span class="nc">PresentationState</span><span class="p">&lt;</span><span class="nc">Unit</span><span class="p">&gt;&gt;(</span>
        <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Loading</span>
    <span class="p">)</span>

    <span class="kd">val</span> <span class="py">state</span> <span class="p">=</span> <span class="n">_state</span><span class="p">.</span><span class="nf">asStateFlow</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">showDialog</span> <span class="p">=</span> <span class="nc">MutableStateFlow</span><span class="p">(</span><span class="k">true</span><span class="p">)</span>

    <span class="nf">init</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">onLoad</span><span class="p">(</span><span class="n">isDataCollectionAllowed</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="step-2"> <a href="#step-2" class="anchor-heading" aria-labelledby="step-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 2 </h3> <p>Since the <a href="ad_sdk/com.adition.ad_sdk.api.core/-ad-service/index.html">AdService</a> configuration contains cookies loading logic, we should obtain permission before calling <a href="ad_sdk/com.adition.ad_sdk.api/-ad-service-provider/configure.html">AdServiceProvider.configure</a>.</p> <p>To do this, we will move the configuration logic from <code class="language-plaintext highlighter-rouge">init</code> to the new <code class="language-plaintext highlighter-rouge">onLoad</code> method. Thus, when configuring <a href="ad_sdk/com.adition.ad_sdk.api.core/-ad-service/index.html">AdService</a>, we will already have the <code class="language-plaintext highlighter-rouge">isDataCollectionAllowed</code> parameter.</p> <p><strong>File:</strong> <code class="language-plaintext highlighter-rouge">MainScreen.kt</code></p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="kd">class</span> <span class="nc">MainViewModel</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">adServiceProvider</span><span class="p">:</span> <span class="nc">AdServiceProviderInterface</span> <span class="p">=</span> <span class="nc">ServiceLocator</span><span class="p">.</span><span class="n">adServiceProvider</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">_state</span> <span class="p">=</span> <span class="nc">MutableStateFlow</span><span class="p">&lt;</span><span class="nc">PresentationState</span><span class="p">&lt;</span><span class="nc">Unit</span><span class="p">&gt;&gt;(</span>
        <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Loading</span>
    <span class="p">)</span>

    <span class="kd">val</span> <span class="py">state</span> <span class="p">=</span> <span class="n">_state</span><span class="p">.</span><span class="nf">asStateFlow</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">showDialog</span> <span class="p">=</span> <span class="nc">MutableStateFlow</span><span class="p">(</span><span class="k">true</span><span class="p">)</span>

    <span class="k">fun</span> <span class="nf">onLoad</span><span class="p">(</span><span class="n">isDataCollectionAllowed</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">viewModelScope</span><span class="p">.</span><span class="nf">launch</span> <span class="p">{</span>
            <span class="n">adServiceProvider</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span>
                <span class="s">"1800"</span><span class="p">,</span>
                <span class="n">parentCoroutineScope</span> <span class="p">=</span> <span class="k">this</span>
            <span class="p">).</span><span class="k">get</span><span class="p">(</span>
                <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">_state</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Loaded</span><span class="p">(</span><span class="nc">Unit</span><span class="p">)</span> <span class="p">},</span>
                <span class="n">onError</span> <span class="p">=</span> <span class="p">{</span> <span class="n">_state</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Error</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">description</span><span class="p">)</span> <span class="p">}</span>
            <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="step-3"> <a href="#step-3" class="anchor-heading" aria-labelledby="step-3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 3 </h3> <p>The final step will be to add a couple of extensions so that we can use <a href="ad_sdk/com.adition.ad_sdk.api.core/-ad-service/index.html">AdService</a> after successful configuration.</p> <p>In this code, after successful configuration via <a href="ad_sdk/com.adition.ad_sdk.api/-ad-service-provider/configure.html">AdServiceProvider.configure</a>, we obtain <a href="ad_sdk/com.adition.ad_sdk.api.core/-ad-service/index.html">AdService</a> using the <a href="ad_sdk/com.adition.ad_sdk.api/-ad-service-provider/get.html">AdServiceProvider.get</a> method. After that, we call the <code class="language-plaintext highlighter-rouge">onSuccess</code> method, which we will use in the future to work with <a href="ad_sdk/com.adition.ad_sdk.api.core/-ad-service/index.html">AdService</a>.</p> <p><strong>File:</strong> <code class="language-plaintext highlighter-rouge">MainScreen.kt</code></p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="kd">class</span> <span class="nc">MainViewModel</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">adServiceProvider</span><span class="p">:</span> <span class="nc">AdServiceProviderInterface</span> <span class="p">=</span> <span class="nc">ServiceLocator</span><span class="p">.</span><span class="n">adServiceProvider</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">fun</span> <span class="nf">onLoad</span><span class="p">(</span><span class="n">isDataCollectionAllowed</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">viewModelScope</span><span class="p">.</span><span class="nf">launch</span> <span class="p">{</span>
            <span class="n">adServiceProvider</span>
                <span class="p">.</span><span class="nf">configure</span><span class="p">(</span>
                    <span class="s">"1800"</span><span class="p">,</span>
                    <span class="n">parentCoroutineScope</span> <span class="p">=</span> <span class="k">this</span>
                <span class="p">)</span>
                <span class="p">.</span><span class="nf">flatMap</span> <span class="p">{</span> <span class="n">adServiceProvider</span><span class="p">.</span><span class="k">get</span><span class="p">()</span> <span class="p">}</span>
                <span class="p">.</span><span class="nf">onSuccess</span> <span class="p">{</span> <span class="n">adService</span> <span class="p">-&gt;</span>
                    
                <span class="p">}</span>
                <span class="p">.</span><span class="k">get</span><span class="p">(</span>
                    <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">_state</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Loaded</span><span class="p">(</span><span class="nc">Unit</span><span class="p">)</span> <span class="p">},</span>
                    <span class="n">onError</span> <span class="p">=</span> <span class="p">{</span> <span class="n">_state</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Error</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">description</span><span class="p">)</span> <span class="p">}</span>
                <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">suspend</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">T</span><span class="p">,</span> <span class="nc">ActionResult</span><span class="p">&gt;</span> <span class="nf">AdResult</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;.</span><span class="nf">flatMap</span><span class="p">(</span>
    <span class="n">action</span><span class="p">:</span> <span class="k">suspend</span> <span class="p">(</span><span class="nc">T</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nc">AdResult</span><span class="p">&lt;</span><span class="nc">ActionResult</span><span class="p">&gt;</span>
<span class="p">):</span> <span class="nc">AdResult</span><span class="p">&lt;</span><span class="nc">ActionResult</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">when</span> <span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">AdResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="nf">action</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">result</span><span class="p">)</span>
        <span class="k">is</span> <span class="nc">AdResult</span><span class="p">.</span><span class="nc">Error</span> <span class="p">-&gt;</span> <span class="nc">AdResult</span><span class="p">.</span><span class="nc">Error</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">suspend</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;</span> <span class="nf">AdResult</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;.</span><span class="nf">onSuccess</span><span class="p">(</span>
    <span class="n">action</span><span class="p">:</span> <span class="k">suspend</span> <span class="p">(</span><span class="nc">T</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nc">Unit</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">AdResult</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">when</span> <span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="nc">AdResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="nf">action</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">result</span><span class="p">)</span>
            <span class="k">this</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="nc">AdResult</span><span class="p">.</span><span class="nc">Error</span> <span class="p">-&gt;</span> <span class="k">this</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Now we can move on to the global parameters!</p> <h2 id="section-2-setting--modifying-global-parameters"> <a href="#section-2-setting--modifying-global-parameters" class="anchor-heading" aria-labelledby="section-2-setting--modifying-global-parameters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Section 2: Setting &amp; modifying global parameters </h2> <p>In this section, we will learn about <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-global-parameters/index.html">GlobalParameters</a> and <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-ad-request-global-parameters/index.html">AdRequestGlobalParameters</a>. We will pass the <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-access-mode/index.html">AccessMode</a> parameter depending on the user’s permission and specify how the server should work with cookies each time <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-ad-request/index.html">AdRequest</a> is executed.</p> <h3 id="step-1-1"> <a href="#step-1-1" class="anchor-heading" aria-labelledby="step-1-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 1 </h3> <p>Let’s continue working in the <code class="language-plaintext highlighter-rouge">MainViewModel</code> and focus on the <code class="language-plaintext highlighter-rouge">onLoad</code> method. Since the <a href="ad_sdk/com.adition.ad_sdk.api/-ad-service-provider/configure.html">AdServiceProvider.configure</a> method includes logic for loading cookies, we should pass user permission before the SDK makes this request. We can do this using the <code class="language-plaintext highlighter-rouge">globalParameters</code> parameter, which accepts <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-global-parameters/index.html">GlobalParameters</a>.</p> <p><a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-global-parameters/index.html">GlobalParameters</a> is an object for storing common global parameters that will be applied when creating an <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-ad-request/index.html">AdRequest</a>, <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-tag-request/index.html">TagRequest</a>, and <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-tracking-request/index.html">TrackingRequest</a>.</p> <p>We will create <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-global-parameters/index.html">GlobalParameters</a> with <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-access-mode/index.html">AccessMode</a>, which will depend on the user’s choice. This way, the ad server will know whether it can identify the user using cookies at the <a href="ad_sdk/com.adition.ad_sdk.api.core/-ad-service/index.html">AdService</a> configuration stage.</p> <p><strong>Note:</strong> <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-global-parameters/access-mode.html">GlobalParameters.accessMode</a> is not the only global parameter for <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-ad-request/index.html">AdRequest</a>, <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-tag-request/index.html">TagRequest</a>, and <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-tracking-request/index.html">TrackingRequest</a>. A list of all global parameters can be found in the <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-global-parameters/index.html">GlobalParameters</a> documentation.</p> <p><strong>File:</strong> <code class="language-plaintext highlighter-rouge">MainScreen.kt</code></p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="kd">class</span> <span class="nc">MainViewModel</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">adServiceProvider</span><span class="p">:</span> <span class="nc">AdServiceProviderInterface</span> <span class="p">=</span> <span class="nc">ServiceLocator</span><span class="p">.</span><span class="n">adServiceProvider</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">fun</span> <span class="nf">onLoad</span><span class="p">(</span><span class="n">isDataCollectionAllowed</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">globalParameters</span> <span class="p">=</span> <span class="nc">GlobalParameters</span><span class="p">(</span>
            <span class="n">accessMode</span> <span class="p">=</span> <span class="n">isDataCollectionAllowed</span><span class="p">.</span><span class="nf">toAccessMode</span><span class="p">()</span>
        <span class="p">)</span>
        
        <span class="n">viewModelScope</span><span class="p">.</span><span class="nf">launch</span> <span class="p">{</span>
            <span class="n">adServiceProvider</span>
                <span class="p">.</span><span class="nf">configure</span><span class="p">(</span>
                    <span class="s">"1800"</span><span class="p">,</span>
                    <span class="n">parentCoroutineScope</span> <span class="p">=</span> <span class="k">this</span><span class="p">,</span>
                    <span class="n">globalParameters</span> <span class="p">=</span> <span class="n">globalParameters</span>
                <span class="p">)</span>
                <span class="p">.</span><span class="nf">flatMap</span> <span class="p">{</span> <span class="n">adServiceProvider</span><span class="p">.</span><span class="k">get</span><span class="p">()</span> <span class="p">}</span>
                <span class="p">.</span><span class="nf">onSuccess</span> <span class="p">{</span> <span class="n">adService</span> <span class="p">-&gt;</span>

                <span class="p">}</span>
                <span class="p">.</span><span class="k">get</span><span class="p">(</span>
                    <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">_state</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Loaded</span><span class="p">(</span><span class="nc">Unit</span><span class="p">)</span> <span class="p">},</span>
                    <span class="n">onError</span> <span class="p">=</span> <span class="p">{</span> <span class="n">_state</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Error</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">description</span><span class="p">)</span> <span class="p">}</span>
                <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">fun</span> <span class="nc">Boolean</span><span class="p">.</span><span class="nf">toAccessMode</span><span class="p">()</span> <span class="p">=</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="nc">AccessMode</span><span class="p">.</span><span class="nc">OPT_IN</span> <span class="k">else</span> <span class="nc">AccessMode</span><span class="p">.</span><span class="nc">OPT_OUT</span>
<span class="c1">// ...</span>
</code></pre></div></div> <h3 id="step-2-1"> <a href="#step-2-1" class="anchor-heading" aria-labelledby="step-2-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 2 </h3> <p>In addition, sometimes you need to be able to modify or remove the <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-global-parameters/index.html">GlobalParameters</a>. You can use <a href="ad_sdk/com.adition.ad_sdk.api.core/-ad-service/set-global-parameters.html">AdService.setGlobalParameters</a> and <a href="ad_sdk/com.adition.ad_sdk.api.core/-ad-service/remove-global-parameter.html">AdService.removeGlobalParameter</a> for this purpose.</p> <p><strong>Note:</strong> You can pass multiple <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-global-parameter/index.html">GlobalParameter</a> at once to the <a href="ad_sdk/com.adition.ad_sdk.api.core/-ad-service/set-global-parameters.html">AdService.setGlobalParameters</a> method by separating them with commas.</p> <p><strong>File:</strong> <code class="language-plaintext highlighter-rouge">MainScreen.kt</code></p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="kd">class</span> <span class="nc">MainViewModel</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">adServiceProvider</span><span class="p">:</span> <span class="nc">AdServiceProviderInterface</span> <span class="p">=</span> <span class="nc">ServiceLocator</span><span class="p">.</span><span class="n">adServiceProvider</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">fun</span> <span class="nf">onLoad</span><span class="p">(</span><span class="n">isDataCollectionAllowed</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">globalParameters</span> <span class="p">=</span> <span class="nc">GlobalParameters</span><span class="p">(</span>
            <span class="n">accessMode</span> <span class="p">=</span> <span class="n">isDataCollectionAllowed</span><span class="p">.</span><span class="nf">toAccessMode</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">viewModelScope</span><span class="p">.</span><span class="nf">launch</span> <span class="p">{</span>
            <span class="n">adServiceProvider</span>
                <span class="p">.</span><span class="nf">configure</span><span class="p">(</span>
                    <span class="s">"1800"</span><span class="p">,</span>
                    <span class="n">parentCoroutineScope</span> <span class="p">=</span> <span class="k">this</span><span class="p">,</span>
                    <span class="n">globalParameters</span> <span class="p">=</span> <span class="n">globalParameters</span>
                <span class="p">)</span>
                <span class="p">.</span><span class="nf">flatMap</span> <span class="p">{</span> <span class="n">adServiceProvider</span><span class="p">.</span><span class="k">get</span><span class="p">()</span> <span class="p">}</span>
                <span class="p">.</span><span class="nf">onSuccess</span> <span class="p">{</span> <span class="n">adService</span> <span class="p">-&gt;</span>
                    <span class="n">adService</span><span class="p">.</span><span class="nf">setGlobalParameters</span><span class="p">(</span>
                        <span class="nc">GlobalParameter</span><span class="p">(</span>
                            <span class="nc">GlobalParameters</span><span class="o">::</span><span class="n">externalUID</span><span class="p">,</span>
                            <span class="nc">ExternalUID</span><span class="p">(</span><span class="s">"uid"</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

                    <span class="n">adService</span><span class="p">.</span><span class="nf">removeGlobalParameter</span><span class="p">(</span><span class="nc">GlobalParameters</span><span class="o">::</span><span class="n">externalUID</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="p">.</span><span class="k">get</span><span class="p">(</span>
                    <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">_state</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Loaded</span><span class="p">(</span><span class="nc">Unit</span><span class="p">)</span> <span class="p">},</span>
                    <span class="n">onError</span> <span class="p">=</span> <span class="p">{</span> <span class="n">_state</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Error</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">description</span><span class="p">)</span> <span class="p">}</span>
                <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// ...</span>
</code></pre></div></div> <h3 id="step-3-1"> <a href="#step-3-1" class="anchor-heading" aria-labelledby="step-3-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 3 </h3> <p>Although <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-global-parameters/index.html">GlobalParameters</a> are added to each <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-ad-request/index.html">AdRequest</a>, <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-tag-request/index.html">TagRequest</a>, and <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-tracking-request/index.html">TrackingRequest</a>, <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-ad-request/index.html">AdRequest</a> has separate <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-ad-request-global-parameters/index.html">AdRequestGlobalParameters</a> that will only be added to it.</p> <p>We implement logic where we allow the server to read cookies if the user has given permission to use personal data. Otherwise, we prohibit the use of cookies. To do this, we use the <code class="language-plaintext highlighter-rouge">adRequestGlobalParameters</code> parameter with the <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-ad-request-global-parameters/-cookies-access/index.html">CookiesAccess</a> property passed.</p> <p><strong>Note:</strong> <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-ad-request-global-parameters/cookies-access.html">AdRequestGlobalParameters.cookiesAccess</a> is not the only global parameter specific for <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-ad-request/index.html">AdRequest</a>. A list of all global parameters can be found in the <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-ad-request-global-parameters/index.html">AdRequestGlobalParameters</a> documentation.</p> <p><strong>File:</strong> <code class="language-plaintext highlighter-rouge">MainScreen.kt</code></p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="kd">class</span> <span class="nc">MainViewModel</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">adServiceProvider</span><span class="p">:</span> <span class="nc">AdServiceProviderInterface</span> <span class="p">=</span> <span class="nc">ServiceLocator</span><span class="p">.</span><span class="n">adServiceProvider</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">fun</span> <span class="nf">onLoad</span><span class="p">(</span><span class="n">isDataCollectionAllowed</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">globalParameters</span> <span class="p">=</span> <span class="nc">GlobalParameters</span><span class="p">(</span>
            <span class="n">accessMode</span> <span class="p">=</span> <span class="n">isDataCollectionAllowed</span><span class="p">.</span><span class="nf">toAccessMode</span><span class="p">()</span>
        <span class="p">)</span>
        
        <span class="kd">val</span> <span class="py">adRequestGlobalParameters</span> <span class="p">=</span> <span class="nc">AdRequestGlobalParameters</span><span class="p">(</span>
            <span class="n">cookiesAccess</span> <span class="p">=</span> <span class="n">isDataCollectionAllowed</span><span class="p">.</span><span class="nf">toCookiesAccess</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">viewModelScope</span><span class="p">.</span><span class="nf">launch</span> <span class="p">{</span>
            <span class="n">adServiceProvider</span>
                <span class="p">.</span><span class="nf">configure</span><span class="p">(</span>
                    <span class="s">"1800"</span><span class="p">,</span>
                    <span class="n">parentCoroutineScope</span> <span class="p">=</span> <span class="k">this</span><span class="p">,</span>
                    <span class="n">globalParameters</span> <span class="p">=</span> <span class="n">globalParameters</span><span class="p">,</span>
                    <span class="n">adRequestGlobalParameters</span> <span class="p">=</span> <span class="n">adRequestGlobalParameters</span>
                <span class="p">)</span>
                <span class="p">.</span><span class="nf">flatMap</span> <span class="p">{</span> <span class="n">adServiceProvider</span><span class="p">.</span><span class="k">get</span><span class="p">()</span> <span class="p">}</span>
                <span class="p">.</span><span class="nf">onSuccess</span> <span class="p">{</span> <span class="n">adService</span> <span class="p">-&gt;</span>
                    <span class="c1">// ...</span>
                <span class="p">}</span>
                <span class="p">.</span><span class="k">get</span><span class="p">(</span>
                    <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">_state</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Loaded</span><span class="p">(</span><span class="nc">Unit</span><span class="p">)</span> <span class="p">},</span>
                    <span class="n">onError</span> <span class="p">=</span> <span class="p">{</span> <span class="n">_state</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Error</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">description</span><span class="p">)</span> <span class="p">}</span>
                <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">fun</span> <span class="nc">Boolean</span><span class="p">.</span><span class="nf">toCookiesAccess</span><span class="p">():</span> <span class="nc">AdRequestGlobalParameters</span><span class="p">.</span><span class="nc">CookiesAccess</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">{</span>
        <span class="nc">AdRequestGlobalParameters</span><span class="p">.</span><span class="nc">CookiesAccess</span><span class="p">.</span><span class="nc">GET</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nc">AdRequestGlobalParameters</span><span class="p">.</span><span class="nc">CookiesAccess</span><span class="p">.</span><span class="nc">NO_COOKIES</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// ...</span>
</code></pre></div></div> <h3 id="step-4"> <a href="#step-4" class="anchor-heading" aria-labelledby="step-4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 4 </h3> <p>Just like with <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-global-parameters/index.html">GlobalParameters</a>, you can modify and remove the <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-ad-request-global-parameter/index.html">AdRequestGlobalParameter</a>. You can use <a href="ad_sdk/com.adition.ad_sdk.api.core/-ad-service/set-ad-request-global-parameters.html">AdService.setAdRequestGlobalParameters</a> and <a href="ad_sdk/com.adition.ad_sdk.api.core/-ad-service/remove-ad-request-global-parameter.html">AdService.removeAdRequestGlobalParameter</a> for this purpose.</p> <p><strong>Note:</strong> You can pass multiple <a href="ad_sdk/com.adition.ad_sdk.api.entities.request.global_parameters/-ad-request-global-parameter/index.html">AdRequestGlobalParameter</a> at once to the <a href="ad_sdk/com.adition.ad_sdk.api.core/-ad-service/set-ad-request-global-parameters.html">AdService.setAdRequestGlobalParameters</a> method by separating them with commas.</p> <p><strong>File:</strong> <code class="language-plaintext highlighter-rouge">MainScreen.kt</code></p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="kd">class</span> <span class="nc">MainViewModel</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">adServiceProvider</span><span class="p">:</span> <span class="nc">AdServiceProviderInterface</span> <span class="p">=</span> <span class="nc">ServiceLocator</span><span class="p">.</span><span class="n">adServiceProvider</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">fun</span> <span class="nf">onLoad</span><span class="p">(</span><span class="n">isDataCollectionAllowed</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">globalParameters</span> <span class="p">=</span> <span class="nc">GlobalParameters</span><span class="p">(</span>
            <span class="n">accessMode</span> <span class="p">=</span> <span class="n">isDataCollectionAllowed</span><span class="p">.</span><span class="nf">toAccessMode</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="kd">val</span> <span class="py">adRequestGlobalParameters</span> <span class="p">=</span> <span class="nc">AdRequestGlobalParameters</span><span class="p">(</span>
            <span class="n">cookiesAccess</span> <span class="p">=</span> <span class="n">isDataCollectionAllowed</span><span class="p">.</span><span class="nf">toCookiesAccess</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">viewModelScope</span><span class="p">.</span><span class="nf">launch</span> <span class="p">{</span>
            <span class="n">adServiceProvider</span>
                <span class="p">.</span><span class="nf">configure</span><span class="p">(</span>
                    <span class="s">"1800"</span><span class="p">,</span>
                    <span class="n">parentCoroutineScope</span> <span class="p">=</span> <span class="k">this</span><span class="p">,</span>
                    <span class="n">globalParameters</span> <span class="p">=</span> <span class="n">globalParameters</span><span class="p">,</span>
                    <span class="n">adRequestGlobalParameters</span> <span class="p">=</span> <span class="n">adRequestGlobalParameters</span>
                <span class="p">)</span>
                <span class="p">.</span><span class="nf">flatMap</span> <span class="p">{</span> <span class="n">adServiceProvider</span><span class="p">.</span><span class="k">get</span><span class="p">()</span> <span class="p">}</span>
                <span class="p">.</span><span class="nf">onSuccess</span> <span class="p">{</span> <span class="n">adService</span> <span class="p">-&gt;</span>
                    <span class="c1">// ...</span>
                    <span class="n">adService</span><span class="p">.</span><span class="nf">setAdRequestGlobalParameters</span><span class="p">(</span>
                        <span class="nc">AdRequestGlobalParameter</span><span class="p">(</span>
                            <span class="nc">AdRequestGlobalParameters</span><span class="o">::</span><span class="n">isIpIdentified</span><span class="p">,</span>
                            <span class="k">true</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                    
                    <span class="n">adService</span><span class="p">.</span><span class="nf">removeAdRequestGlobalParameter</span><span class="p">(</span>
                        <span class="nc">AdRequestGlobalParameters</span><span class="o">::</span><span class="n">isIpIdentified</span>
                    <span class="p">)</span>
                <span class="p">}</span>
                <span class="p">.</span><span class="k">get</span><span class="p">(</span>
                    <span class="n">onSuccess</span> <span class="p">=</span> <span class="p">{</span> <span class="n">_state</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Loaded</span><span class="p">(</span><span class="nc">Unit</span><span class="p">)</span> <span class="p">},</span>
                    <span class="n">onError</span> <span class="p">=</span> <span class="p">{</span> <span class="n">_state</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="nc">PresentationState</span><span class="p">.</span><span class="nc">Error</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">description</span><span class="p">)</span> <span class="p">}</span>
                <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// ...</span>
</code></pre></div></div> <p>Now the ad server will know whether it has permission to process personal data each time <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-ad-request/index.html">AdRequest</a>, <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-tag-request/index.html">TagRequest</a>, and <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-tracking-request/index.html">TrackingRequest</a> are executed. In addition, we have specified how the server should work with cookies when <a href="ad_sdk/com.adition.ad_sdk.api.entities.request/-ad-request/index.html">AdRequest</a> is executed. Congratulations!</p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
